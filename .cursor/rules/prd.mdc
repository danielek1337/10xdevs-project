---
description: Product Requirements Document for VibeCheck application
globs:
alwaysApply: false
---
# Product Requirements Document - VibeCheck

## Product Overview

VibeCheck is a productivity tracking application that helps developers monitor their flow state and productivity levels throughout the day. Users can log their mood, tasks, and focus levels, with automatic calculation of daily productivity metrics.

**Authentication Required:** The application requires users to create an account and log in to access all features. Unauthenticated users can only view the landing page with login/signup options.

## Tech Stack

- Astro 5
- TypeScript 5
- React 19
- Tailwind 4
- Shadcn/ui
- Supabase (Auth + Database + RLS)
- Playwright (E2E testing)
- Vitest (Unit testing)
- GitHub Actions (CI/CD)
- Vercel (Deployment)

## Core Features & Requirements

### Authentication & Access Control

- **Authentication Required:** All application features require user authentication
- Landing page (`/`) is public and displays welcome message with login/signup options
- Dashboard (`/dashboard`) and all other pages require active authentication session
- Use Supabase Auth with Email/Password authentication only
- No external OAuth providers (Google, GitHub, etc.)
- Implement Row Level Security (RLS) to ensure users can only access their own entries
- All database queries must respect RLS policies
- Protect API endpoints with authentication middleware
- Middleware redirects unauthenticated users to landing page
- Password recovery functionality must be available

### Data Management (CRUD Operations)

#### Create
- Add new productivity entry with:
  - Mood rating (1-5 scale)
  - Task description
  - Tags for categorization
  - Automatic timestamp

#### Read
- Dashboard displaying history of all user entries
- Filter and sort capabilities by date, mood, tags
- Visual representation of productivity trends

#### Update
- Allow editing notes/descriptions of existing entries
- Preserve original timestamp and metadata

#### Delete
- Remove incorrect or unwanted log entries
- Soft delete option for data recovery

### Business Logic

#### Daily Focus Score Calculation
- Automatically calculate "Daily Focus Score" based on:
  - Mood ratings from entries throughout the day
  - Frequency of entries (consistency indicator)
  - Time distribution of productive periods
- Score should be recalculated when entries are added/updated/deleted

#### Validation Rules
- Anti-spam: Maximum one entry per 5 minutes per user
- Mood rating must be between 1-5
- Task description required (min 3 characters)
- Tags must follow allowed format (alphanumeric, max 20 chars each)

#### Data Formatting
- Format work time into readable statistics (hours, minutes)
- Display timestamps in user-friendly format
- Calculate time gaps between entries
- Generate daily/weekly/monthly summaries

## Testing Requirements

### Unit Tests (Vitest)
- Test Daily Focus Score calculation function with various inputs
- Test validation functions (anti-spam, mood range, etc.)
- Test data formatting utilities
- Test business logic edge cases

### E2E Tests (Playwright)
- Test complete authentication flow (signup, login, logout)
- Test creating a new productivity entry
- Test editing and deleting entries
- Test dashboard data display
- Test that users cannot access other users' data

## CI/CD Pipeline

### GitHub Actions Workflow
- Run on every push to any branch
- Execute all unit tests (Vitest)
- Execute all E2E tests (Playwright)
- Check TypeScript compilation
- Run ESLint for code quality
- Automatic deployment to Vercel on main branch (only if all tests pass)
- Generate test coverage reports

## User Stories

### As a developer, I want to:
- Log my current mood and task to track my productivity throughout the day
- View my productivity history to understand my work patterns
- See my Daily Focus Score to gauge my overall productivity
- Filter my entries by date, mood, or tags to analyze specific periods
- Edit my entries if I made a mistake or want to add more context
- Delete entries that I no longer want to track

### As a productivity-conscious user, I need:
- Visual representations of my productivity trends over time
- Daily, weekly, and monthly summaries of my work patterns
- Automatic calculations that help me understand my focus levels
- A simple interface that doesn't interrupt my flow state

### As a new user, I want to:
- Register for an account using email and password
- Receive clear validation feedback during registration
- Log in to access my personal productivity dashboard
- Recover my password if I forget it

### As an authenticated user, I want to:
- Access all application features after logging in
- Stay logged in across browser sessions (remember me)
- Log out securely when I'm done
- Have confidence that my data is private and secure

## Success Metrics

- User can create a new entry in less than 30 seconds
- Daily Focus Score is calculated and displayed in real-time
- All user data is protected by RLS with zero cross-user data access
- Application loads in under 2 seconds
- 95%+ test coverage for business logic
- Zero security vulnerabilities in authentication flow
